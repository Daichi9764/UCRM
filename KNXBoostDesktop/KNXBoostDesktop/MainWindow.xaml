<mah:MetroWindow  x:Name="MainGrid" x:Class="KNXBoostDesktop.MainWindow"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:local="clr-namespace:KNXBoostDesktop"
                  xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                  mc:Ignorable="d"
                  Height="450" Width="800"
                  MinWidth="309"
                  MinHeight="165"
                  Background="#F5F5F5"
                  Closing="ClosingMainWindow"
                  WindowTitleBrush="#369026"
                  NonActiveWindowTitleBrush="#4a9b3c"
                  TitleCharacterCasing="Normal"
                  ShowIconOnTitleBar="False"
                  FontFamily="{StaticResource AptosFontFamily}"
                  Icon="pack://application:,,,/resources/iconApp.ico">
    
    <!-- Paramètres du logo dans la barre de titre -->
    <mah:MetroWindow.LeftWindowCommands>
        <mah:WindowCommands>
            <StackPanel Background="Transparent" Width="130" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Image Height="40" Margin="0,5" >
                <Image.Source>
                    <DrawingImage>
                            <DrawingImage.Drawing>
                                <DrawingGroup ClipGeometry="M0,0 V600 H1579.23 V0 H0 Z">
                                    <GeometryDrawing Brush="#FFFFFFFF">
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry RadiusX="0" RadiusY="0" Rect="136.92,261.63,60.09,188.15" />
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M409.76,261.63L409.76,261.63 409.76,356.21 336.38,292.68 271.37,355.72 271.37,433.53 197.01,356.7 290.64,261.63 409.76,261.63z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M543.48,358.42L543.48,358.42 630.11,449.78 558.61,449.78 505.8,395.61 449.79,449.78 329.98,449.78 329.98,354.5 404.96,420.38 467.63,357.93 466.89,284.8 505.43,321.36 563.99,261.63 637.39,261.63 543.48,358.42z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M923.27,311.89C926.43,300.28 926.63,290.2 923.87,281.92 920.96,273.26 915.88,267.57 908.77,264.99 902.19,262.61 892.42,261.45 878.92,261.45L824.73,261.45 816.16,292.88 804.34,336.24 795.72,367.86 781.81,418.91 773.31,450.09 830.04,450.09C853.55,450.09 871.23,444.75 882.6,434.19 893.77,423.8 901.37,411.46 905.17,397.5 905.39,396.69 905.6,395.9 905.79,395.11 905.98,394.32 906.15,393.55 906.32,392.77 906.41,392.39 906.48,392.01 906.56,391.63 906.71,390.87 906.84,390.11 906.97,389.37 907.9,383.74 908.05,378.62 907.41,374 907.26,372.88 907.06,371.79 906.81,370.73 906.65,370.02 906.46,369.33 906.26,368.65 906.05,367.97 905.83,367.3 905.58,366.65 905.33,365.99 905.07,365.35 904.78,364.72 904.63,364.41 904.48,364.1 904.33,363.79 903.26,361.65 901.93,359.67 900.34,357.85 900.11,357.59 899.88,357.34 899.65,357.09 899.41,356.83 899.17,356.58 898.92,356.34 896.95,354.37 894.66,352.63 892.03,351.1 907.73,343.56 918.22,330.4 923.27,311.89z M870.64,392.33C865.68,410.5,853.89,419.34,834.62,419.34L816.27,419.34 830.56,366.87 848.34,366.87C856.65,366.87 867.09,368.11 869.78,374 872.26,379.38 872.53,385.37 870.64,392.33z M887.06,312.85C885.09,320.02 881.64,325.94 876.78,330.42 872.1,334.73 863.85,336.93 852.21,336.93L838.72,336.93 851.13,291.39 869.18,291.39C877.69,291.39 883.44,293.01 886.25,296.2 888.96,299.26 889.23,304.85 887.06,312.85z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M1063.5,284.05C1056.81,266.84 1042.68,258.11 1021.49,258.11 1000.3,258.11 982.2,266.52 966.76,283.12 951.61,299.4 939.61,323.54 931.07,354.85 922.41,386.59 921.32,411.04 927.81,427.5 934.57,444.69 948.83,453.42 970.18,453.42 991.53,453.42 1009.18,445.02 1024.52,428.47 1039.57,412.24 1051.55,388.04 1060.13,356.54 1068.77,324.88 1069.9,300.48 1063.51,284.03z M976.9,422.15C966.56,422.15 961.28,417.08 960.3,406.2 959.21,394.02 961.51,377.34 967.16,356.62 972.91,335.51 979.81,318.66 987.64,306.55 995.11,295.01 1003.89,289.39 1014.5,289.39 1024.46,289.39 1029.62,294.37 1030.76,305.06 1030.98,307.19 1031.1,309.49 1031.1,311.94 1031.1,323.15 1028.73,337.58 1024,354.92 1018.11,376.46 1011.17,393.4 1003.31,405.29 995.81,416.63 987.18,422.15 976.89,422.15z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M1207.42,284.05C1200.73,266.84 1186.6,258.11 1165.41,258.11 1144.22,258.11 1126.12,266.52 1110.68,283.12 1095.54,299.4 1083.54,323.54 1074.99,354.85 1066.35,386.59 1065.24,411.04 1071.73,427.5 1078.49,444.69 1092.75,453.42 1114.1,453.42 1135.45,453.42 1153.1,445.02 1168.44,428.47 1183.49,412.24 1195.47,388.04 1204.06,356.54 1212.69,324.88 1213.81,300.48 1207.42,284.03z M1120.82,422.15C1110.48,422.15 1105.21,417.08 1104.22,406.2 1103.13,394.02 1105.43,377.34 1111.08,356.62 1116.83,335.51 1123.73,318.66 1131.57,306.55 1139.04,295.01 1147.83,289.39 1158.45,289.39 1168.39,289.39 1173.55,294.37 1174.7,305.06 1174.94,307.21 1175.04,309.51 1175.04,311.97 1175.04,323.18 1172.67,337.59 1167.94,354.92 1162.07,376.46 1155.11,393.4 1147.25,405.29 1139.77,416.63 1131.12,422.15 1120.83,422.15z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M1267.81,310.08C1266.28,315.7 1266.85,319.95 1269.58,323.06 1271.72,325.52 1277.32,329.85 1291.73,336.43 1302.41,341.32 1310.21,345.89 1315.56,350.38 1321.14,355.07 1325.05,361.41 1327.13,369.19 1329.2,376.88 1328.88,385.8 1326.16,395.76 1321.84,411.65 1312.77,425.37 1299.25,436.51 1285.64,447.73 1269.11,453.42 1250.14,453.42 1234.26,453.42 1222.1,449.19 1214.03,440.82 1205.22,431.71 1201.25,417.64 1202.21,399L1202.34,396.64 1236.58,387.1 1236.23,391.81C1235.37,403.17 1237.24,411.37 1241.8,416.18 1245.42,420.02 1250.78,421.87 1258.2,421.87 1266.54,421.87 1273.27,419.67 1278.77,415.13 1284.27,410.57 1287.99,404.86 1289.82,398.2 1291.1,393.46 1290.9,389.22 1289.2,385.26 1288.07,382.65 1283.94,378.23 1270.68,372.18 1258.18,366.51 1249.54,361.8 1244.29,357.78 1238.76,353.55 1234.74,347.28 1232.33,339.17 1229.94,331.14 1230.13,321.98 1232.87,311.91 1236.99,296.8 1245.48,283.94 1258.13,273.67 1270.83,263.35 1285.58,258.11 1301.96,258.11 1316.19,258.11 1327.19,261.88 1334.66,269.3 1342.67,277.23 1346.62,289.4 1346.43,305.45L1346.41,307.8 1313.24,318.96 1313.16,314.43C1312.98,305.5 1311.38,298.94 1308.43,294.92 1305.71,291.2 1301.01,289.38 1294.12,289.38 1287.23,289.38 1281.99,291.41 1277.27,295.56 1272.48,299.79 1269.3,304.67 1267.82,310.07z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M1474.85,261.45L1474.85,261.45 1466.05,293.67 1427.96,293.67 1385.31,450.09 1350.12,450.09 1392.76,293.67 1354.9,293.67 1363.7,261.45 1474.85,261.45z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M607.96,426.42L607.96,426.42 630.11,449.78 558.61,449.78 535.84,426.42 607.96,426.42z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M750.72,418.91L750.72,418.91 744.37,442.2 742.1,450.52 714.87,450.52 684.9,418.91 750.72,418.91z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M773.25,336.24L773.25,336.24 764.63,367.86 636.49,367.86 628,358.91 650,336.24 773.25,336.24z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M574.85,261.63L574.85,261.63 637.39,261.63 612.95,286.82 568.11,286.82 574.85,261.63z" />
                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M1579.23,600z M0,0z M793.68,261.26L793.68,261.26 785.06,292.88 692.07,292.88 722.74,261.26 793.68,261.26z" />
                                </DrawingGroup>
                            </DrawingImage.Drawing>
                        </DrawingImage>
                </Image.Source>
            </Image>
            </StackPanel>
        </mah:WindowCommands>
    </mah:MetroWindow.LeftWindowCommands>

    <mah:MetroWindow.TaskbarItemInfo>
        <TaskbarItemInfo x:Name="TaskbarInfo"/>
    </mah:MetroWindow.TaskbarItemInfo>

    <mah:MetroWindow.Resources>
        
        <!-- Import pour rétracter les boutons Charger et Exporter -->
        <local:WidthBelowThresholdConverter x:Key="WidthConverterCharger" Threshold="627" /> 
        <local:WidthBelowThresholdConverter x:Key="WidthConverterExport" Threshold="500" />
        
        <Style x:Key="TreeViewItemStyle2" TargetType="TreeViewItem">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="Foreground" Value="#000000"/>
            <EventSetter Event="Expanded" Handler="TreeViewItem_Expanded"/>
            <EventSetter Event="Collapsed" Handler="TreeViewItem_Collapsed"/>
        </Style>
        <Style x:Key="TreeViewItemStyleDark" TargetType="{x:Type TreeViewItem}">
            <Setter Property="Background" Value="#262626"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <EventSetter Event="Expanded" Handler="TreeViewItem_Expanded"/>
            <EventSetter Event="Collapsed" Handler="TreeViewItem_Collapsed"/>
            
        </Style>

        
        <!-- Style pour le bouton Exporter -->
        <Style x:Key="ExportButton" TargetType="Button">
            <Setter Property="Background" Value="#4071B4"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <Setter Property="FontSize" Value="12"/>            
            <Setter Property="Height" Value="25"/>
            <Setter Property="Padding" Value="0,0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="btnBorder" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="0"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Image Grid.Column="0" Width="15" Height="15" Margin="5,0,5,0" VerticalAlignment="Center">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V800 H800 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <DrawingGroup Opacity="1">
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M800,800z M0,0z M415.7,6.6C411.4,2.3 405.6,0 400,0 394.4,0 388.6,2.1 384.3,6.6L207,183.9C198.3,192.6 198.3,206.7 207,215.4 215.7,224.1 229.8,224.1 238.5,215.4L377.7,76.2 377.7,609C377.7,621.4 387.6,631.3 400,631.3 412.4,631.3 422.3,621.4 422.3,609L422.3,76.2 561.5,215.4C570.2,224.1 584.3,224.1 593,215.4 601.7,206.7 601.7,192.6 593,183.9L415.7,6.6z" />
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M800,800z M0,0z M703.5,755.5L96.5,755.5C84.1,755.5 74.2,765.4 74.2,777.8 74.2,790.2 84.1,800.1 96.5,800.1L703.5,800.1C715.9,800.1 725.8,790.2 725.8,777.8 725.8,765.4 715.9,755.5 703.5,755.5z" />
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                                <TextBlock x:Name="txtblock" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center" Text="{TemplateBinding Content}" Margin="0,0,10,0"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="btnBorder" Property="Background" Value="Gray"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#355e97"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#355e97"/>
                            </Trigger>
                            <!-- Trigger when ActualWidth is below the threshold -->
                            <DataTrigger Binding="{Binding ActualWidth, ElementName=MainGrid, Converter={StaticResource WidthConverterExport}}" Value="True">
                                <Setter TargetName="txtblock" Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <!-- Default style when ActualWidth is above the threshold -->
                            <DataTrigger Binding="{Binding ActualWidth, ElementName=MainGrid, Converter={StaticResource WidthConverterExport}}" Value="False">
                                <Setter Property="Background" Value="#4071B4"/>
                                <Setter Property="Foreground" Value="White"/>
                            </DataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Style pour le bouton Charger -->
        <Style x:Key="ChargerButton" TargetType="Button">
            <Setter Property="Background" Value="#4071B4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>            
            <Setter Property="Height" Value="25"/>
            <Setter Property="Padding" Value="0,0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="btnBorder" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="0"
                                Width="{TemplateBinding Width}"
                                Height="{TemplateBinding Height}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Image Grid.Column="0" Width="15" Height="15" Margin="5,0,5,0" VerticalAlignment="Center">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V800 H800 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <DrawingGroup Opacity="1">
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M800,800z M0,0z M384.3,624.7C388.6,629 394.4,631.3 400,631.3 405.6,631.3 411.4,629.2 415.7,624.7L593,447.3C601.7,438.6 601.7,424.5 593,415.8 584.3,407.1 570.2,407.1 561.5,415.8L422.3,555.1 422.3,22.3C422.3,9.9 412.4,0 400,0 387.6,0 377.7,9.9 377.7,22.3L377.7,555.1 238.5,415.8C229.8,407.1 215.7,407.1 207,415.8 198.3,424.5 198.3,438.6 207,447.3L384.3,624.7z" />
                                                            <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M800,800z M0,0z M703.5,755.5L96.5,755.5C84.1,755.5 74.2,765.4 74.2,777.8 74.2,790.2 84.1,800.1 96.5,800.1L703.5,800.1C715.9,800.1 725.8,790.2 725.8,777.8 725.8,765.4 715.9,755.5 703.5,755.5z" />
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                                <TextBlock x:Name="txtblock" Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center" Text="{TemplateBinding Content}" Margin="0,0,10,0"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#355e97"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#355e97"/>
                            </Trigger>
                            <!-- Trigger when ActualWidth is below the threshold -->
                            <DataTrigger Binding="{Binding ActualWidth, ElementName=MainGrid, Converter={StaticResource WidthConverterCharger}}" Value="True">
                                <Setter TargetName="txtblock" Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <!-- Default style when ActualWidth is above the threshold -->
                            <DataTrigger Binding="{Binding ActualWidth, ElementName=MainGrid, Converter={StaticResource WidthConverterCharger}}" Value="False">
                                <Setter Property="Background" Value="#4071B4"/>
                                <Setter Property="Foreground" Value="White"/>
                            </DataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style pour le bouton Paramètres en mode LIGHT -->
        <Style x:Key="SettingsButtonLight" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            CornerRadius="0">
                            <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" x:Name="BackgroundSettingsOver" Property="Background" Value="#D3D3D3"/>
                                <Setter TargetName="border" x:Name="BorderSettingsOver" Property="BorderBrush" Value="#b8b8b8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#a8a8a8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Style pour le bouton Paramètres en mode DARK -->
        <Style x:Key="SettingsButtonDark" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="0">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#434343"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#262626"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style bouton invisible -->
        <Style x:Key="ToggleButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#D3D3D3"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="#D7D7D7" />
        </Style>
        
        <!-- Style pour les chevrons en mode DARK -->
        <Style x:Key="ToggleButtonStyleDark" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#262626"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="#D7D7D7" />
        </Style>
        
    </mah:MetroWindow.Resources>
    
    <Border BorderBrush="#369226" 
            BorderThickness="1" 
            Padding="10,5,10,10">
        
        <Grid>
            <Grid x:Name="MainContent">
                <Grid.RowDefinitions>
                    <!-- Recherche et boutons -->
                    <RowDefinition Height="Auto"/>
                    <!-- Arbres -->
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
            
                <!-- Recherge et Boutons -->
                <Grid Grid.Row="0" Margin="10,5,10,10">
                    <Grid.ColumnDefinitions>
                        <!-- Pour le champ de recherche -->
                        <ColumnDefinition Width="Auto"/>
                        <!-- Pour les boutons de droite -->
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Bouton de recherche à gauche -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Grid>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0">
                                <Border x:Name="Recherche" BorderBrush="#D7D7D7" BorderThickness="1" CornerRadius="0" Background="White" Margin="-10,0,0,0" Padding="0" Height="25">
                                    <DockPanel>
                                        <!-- Image de loupe -->
                                        <Image Width="15" Height="15" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5,0,5,0">
                                            <Image.Source>
                                                <DrawingImage>
                                                    <DrawingImage.Drawing>
                                                        <DrawingGroup ClipGeometry="M0,0 V191.27 H191.2 V0 H0 Z">
                                                            <DrawingGroup.Transform>
                                                                <TranslateTransform X="0.004999995231628418" Y="0.0076204603537917137" />
                                                            </DrawingGroup.Transform>
                                                            <DrawingGroup Opacity="1">
                                                                <GeometryDrawing x:Name="LogoRecherche" Brush="#FF000000" Geometry="F1 M191.2,191.27z M0,0z M72.86,100.05C63.1,84.57 59.89,68.01 63.87,50.27 67.42,34.43 75.92,21.7 89.06,12.18 115.15,-6.72000000000001 151.18,-3.30000000000001 173.47,20.09 195.69,43.4 197.19,79.62 176.98,104.87 156.72,130.18 119.8,136.99 91.26,118.36 83.38,126.25 44.52,165.11 36.62,173.01 31.79,177.85 26.95,182.68 22.13,187.5 17.11,192.52 8.96999999999999,192.52 3.93999999999999,187.5 3.87999999999999,187.44 3.81999999999999,187.38 3.75999999999999,187.32 -1.26000000000001,182.3 -1.26000000000001,174.15 3.75999999999999,169.13 16.43,156.47 60.12,112.78 72.86,100.05z M125.48,23.05C103.79,23.7 86.08,41.32 85.32,63.01 84.48,86.99 104.07,106.65 128.06,105.91 149.76,105.24 167.46,87.58 168.17,65.88 168.96,41.94 149.41,22.34 125.48,23.05z" />
                                                            </DrawingGroup>
                                                        </DrawingGroup>
                                                    </DrawingImage.Drawing>
                                                </DrawingImage>
                                            </Image.Source>
                                        </Image>
                                        <!-- TextBox avec texte temporaire -->
                                        <TextBox x:Name="TxtSearch1" 
                                                 Width="140" Height="25"
                                                 VerticalContentAlignment="Center" Margin="0,0,0,0" 
                                                 BorderThickness="0" Background="Transparent"
                                                 Foreground="Gray" VerticalAlignment="Center"
                                                 GotFocus="TextBox_GotFocus" LostFocus="TextBox_LostFocus"
                                                 PreviewKeyDown="txtSearch1_PreviewKeyDown"
                                                 TextChanged="TxtSearch_TextChanged">
                                        </TextBox>
                                    </DockPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </StackPanel>

                    <!-- Boutons à droite -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right">
                        <!-- Bouton de paramètres -->
                        <Button x:Name="ButtonSettings" Width="25" Height="25"
                                Click="OpenParameters"
                                Margin="0,0,10,0" 
                                Background="White"
                                BorderThickness="1" BorderBrush="#D7D7D7"
                                Padding="0"
                                Style="{StaticResource SettingsButtonLight}">

                            <Image Width="15" Height="15"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   Margin="0" Stretch="Fill">
                                <Image.Source>
                                    <DrawingImage>
                                        <DrawingImage.Drawing>
                                            <DrawingGroup ClipGeometry="M0,0 V200 H200 V0 H0 Z">
                                                <DrawingGroup.Transform>
                                                    <TranslateTransform X="0" Y="0.0099999997764825821" />
                                                </DrawingGroup.Transform>
                                                <GeometryDrawing x:Name="BrushSettings1" Brush="#000000" Geometry="F1 M200,200z M0,0z M108.98,199.8C102.99,199.8 97,199.8 91.01,199.8 90.92,199.77 90.83,199.73 90.73,199.72 87.08,199.33 83.82,197.97 80.93,195.7 78.69,193.94 76.95,191.78 75.68,189.24 74.25,186.37 73.61,183.33 73.67,180.13 73.69,179.07 73.6,178.02 73.18,177.02 72.29,174.9 70.75,173.41 68.72,172.37 65.56,170.75 61.32,170.95 58.52,173.84 54.73,177.75 49.96,179.48 44.52,179.18 40.17,178.94 36.33,177.37 33.18,174.35 29.7,171 26.34,167.52 22.89,164.13 18.57,159.87 16.46,154.73 16.71,148.67 16.9,144.16 18.45,140.11 21.43,136.69 22.79,135.13 24.32,133.74 25.74,132.24 26.1,131.86 26.4,131.38 26.56,130.88 27.23,128.77 25.52,126.07 23.08,126.19 21.13,126.28 19.17,126.27 17.23,126.08 12.85,125.67 9.06,123.88 5.9,120.82 2.19,117.22 0.180000000000004,112.83 0.0900000000000043,107.65 0.0100000000000043,102.48 0.0400000000000043,97.3 0.0800000000000043,92.12 0.110000000000004,88.23 1.36,84.71 3.63,81.57 6.64,77.41 10.67,74.8 15.72,73.91 17.59,73.58 19.54,73.68 21.45,73.55 22.19,73.5 22.96,73.44 23.64,73.18 25.28,72.56 26.33,71.3 27.04,69.72 28.03,67.51 27.8,64.82 25.86,62.97 25.02,62.17 24.22,61.34 23.4,60.53 19.47,56.62 17.32,51.9 17.1,46.35 16.86,40.5 18.77,35.4 22.78,31.15 25.38,28.39 28.11,25.76 30.8,23.08 31.34,22.54 31.91,22.03 32.51,21.56 37.08,17.98 42.26,16.47 48.04,17.15 52.15,17.63 55.84,19.16 58.98,21.87 60.42,23.11 61.74,24.49 63.1,25.82 63.82,26.53 64.63,27.08 65.62,27.33 67.56,27.82 69.34,27.4 70.96,26.31 72.6,25.21 73.62,23.7 73.64,21.65 73.65,20.85 73.65,20.06 73.64,19.26 73.62,15.83 74.45,12.63 76.13,9.63999999999997 77.61,7.00999999999997 79.62,4.86999999999997 82.12,3.18999999999997 84.05,1.88999999999997 86.15,0.939999999999974 88.44,0.469999999999974 89.34,0.279999999999974 90.25,0.149999999999974 91.16,-0.0100000000000264 97.02,-0.0100000000000264 102.88,-0.0100000000000264 108.74,-0.0100000000000264 108.88,0.0199999999999736 109.02,0.0599999999999736 109.16,0.0899999999999736 110.2,0.279999999999974 111.26,0.379999999999974 112.27,0.669999999999974 116.77,1.92999999999997 120.36,4.50999999999997 122.98,8.36999999999997 124.93,11.23 126.07,14.42 126.21,17.91 126.28,19.6 126.25,21.29 126.27,22.99 126.28,23.36 126.29,23.75 126.38,24.1 127.01,26.4 130.53,27.61 132.37,25.64 133.39,24.55 134.47,23.51 135.53,22.45 138.87,19.11 142.91,17.2 147.59,16.74 153.83,16.13 159.26,18 163.75,22.4 167.17,25.75 170.55,29.14 173.9,32.55 179.29,38.02 180.77,45.88 177.77,52.85 176.8,55.09 175.42,57.04 173.66,58.73 172.73,59.63 172.05,60.68 171.71,61.94 171.13,64.03 171.32,66.07 172.15,68.05 173.14,70.39 174.76,72.15 177.15,73.13 178.05,73.5 179,73.6 179.97,73.59 181.9,73.57 183.81,73.71 185.67,74.23 190.08,75.46 193.65,77.89 196.32,81.62 198.55,84.75 199.81,88.23 199.85,92.09 199.9,97.27 199.91,102.44 199.85,107.62 199.8,112.25 198.14,116.3 195.09,119.75 192.28,122.94 188.75,124.95 184.59,125.83 182.6,126.25 180.58,126.24 178.56,126.24 178.07,126.24 177.58,126.24 177.11,126.34 174.39,126.92 172.48,129.71 172.32,132.32 172.2,134.24 172.96,135.75 174.33,137.09 178.72,141.39 180.48,146.62 179.47,152.69 178.87,156.35 177.09,159.44 174.47,162.05 170.37,166.14 166.26,170.22 162.17,174.33 159.05,177.46 155.35,179.32 150.91,179.64 147.47,179.89 144.25,179.17 141.24,177.49 139.54,176.55 138.13,175.26 136.73,173.93 136.22,173.45 135.62,172.98 134.98,172.72 132.55,171.74 130.34,172.33 128.37,173.91 126.93,175.06 126.22,176.59 126.25,178.47 126.27,179.96 126.25,181.47 126.1,182.95 125.69,186.89 124.11,190.33 121.51,193.3 118.8,196.4 115.43,198.41 111.42,199.34 110.65,199.54 109.81,199.65 108.98,199.8z M100.03,10.55C100.03,10.55 100.03,10.56 100.03,10.56 97.36,10.56 94.69,10.47 92.02,10.58 88.19,10.74 84.78,13.97 84.36,17.76 84.22,19.03 84.24,20.33 84.25,21.61 84.28,28.43 79.79,34.43 73.43,36.9 70.6,38 67.68,38.36 64.66,37.89 62.04,37.48 59.6,36.6 57.55,34.91 56.01,33.64 54.59,32.21 53.19,30.79 51.19,28.77 48.82,27.66 45.99,27.56 43.32,27.47 40.84,28.18 38.89,30.03 35.97,32.79 33.12,35.64 30.35,38.55 26.93,42.14 26.69,47.9 29.76,51.77 30.86,53.15 32.17,54.37 33.42,55.62 36.2,58.39 37.75,61.71 38.1,65.61 38.43,69.27 37.64,72.71 35.76,75.85 32.81,80.77 28.52,83.67 22.71,84.11 21.61,84.19 20.5,84.12 19.39,84.17 18.63,84.2 17.85,84.23 17.12,84.41 13.24,85.35 10.67,88.6 10.64,92.64 10.6,97.47 10.65,102.31 10.62,107.14 10.59,111.86 14.58,115.81 19.31,115.66 20.63,115.62 21.95,115.65 23.27,115.66 25.31,115.68 27.3,116.01 29.13,116.94 33.64,119.23 36.34,122.88 37.12,127.87 37.74,131.81 36.84,135.43 34.29,138.52 33.04,140.03 31.57,141.37 30.19,142.77 28.8,144.18 27.79,145.81 27.44,147.78 26.85,151.09 27.72,153.97 30.08,156.37 31.97,158.28 33.87,160.17 35.78,162.07 37.34,163.62 38.86,165.21 40.47,166.7 43.25,169.27 47.39,169.4 50.35,167.07 51.13,166.46 51.81,165.72 52.56,165.08 56.96,161.37 62.07,160.18 67.67,161.06 71.67,161.69 75.2,163.42 78.18,166.18 81.11,168.89 83.17,172.15 83.88,176.12 84.18,177.76 84.19,179.45 84.26,181.12 84.46,185.52 87.88,189.09 92.28,189.23 96.13,189.36 99.99,189.28 103.85,189.28 105.2,189.28 106.55,189.31 107.9,189.23 111.62,189.03 114.94,186.15 115.55,182.49 115.78,181.11 115.74,179.67 115.74,178.26 115.76,174.65 116.84,171.42 119.02,168.55 121.78,164.93 125.45,162.79 129.91,161.98 133.22,161.37 136.42,161.79 139.5,163.13 141.5,164 143.16,165.34 144.7,166.87 145.36,167.52 146.12,168.15 146.95,168.55 149.54,169.79 152.42,169.21 154.49,167.15 156.25,165.41 157.99,163.65 159.74,161.9 162.36,159.27 165.01,156.67 167.58,154 169.37,152.14 169.75,149.2 168.67,146.85 168.17,145.75 167.34,144.93 166.5,144.11 163.77,141.44 162.25,138.18 161.91,134.4 161.41,128.88 163.19,124.13 167.11,120.24 169.78,117.59 173.03,116.02 176.82,115.72 178.24,115.61 179.68,115.66 181.11,115.64 185.51,115.56 189.15,112.03 189.33,107.63 189.4,106.04 189.36,104.44 189.36,102.85 189.36,99.27 189.4,95.69 189.32,92.11 189.25,88.89 186.95,85.86 183.95,84.72 182.64,84.22 181.29,84.16 179.92,84.16 176.86,84.1499999999999 173.96,83.4799999999999 171.26,81.99 167.3,79.8 164.46,76.5899999999999 162.62,72.4799999999999 161.04,68.9499999999999 160.49,65.2599999999999 161.08,61.4199999999999 161.7,57.3999999999999 163.47,53.9699999999999 166.39,51.1099999999999 167.04,50.4699999999999 167.61,49.6899999999999 168.02,48.8799999999999 169.32,46.3099999999999 169.13,42.5599999999999 166.37,39.8699999999999 163.01,36.5999999999999 159.75,33.2299999999999 156.4,29.9499999999999 155.69,29.2499999999999 154.86,28.6199999999999 153.97,28.1799999999999 150.14,26.2799999999999 145.97,27.0099999999999 142.92,30.0199999999999 141.88,31.0499999999999 140.84,32.0899999999999 139.81,33.1299999999999 137.79,35.1699999999999 135.37,36.5199999999999 132.55,36.9599999999999 127.17,37.8099999999999 122.61,36.1499999999999 119.01,32.0599999999999 117.02,29.7899999999999 115.9,27.1099999999999 115.78,24.0699999999999 115.71,22.2999999999999 115.77,20.5199999999999 115.72,18.7499999999999 115.6,14.3199999999999 112.15,10.7499999999999 107.73,10.5699999999999 105.18,10.47 102.6,10.55 100.03,10.55z" />
                                                <GeometryDrawing x:Name="BrushSettings2" Brush="#000000" Geometry="F1 M200,200z M0,0z M99.91,63.09C120.21,63.01 136.73,79.42 136.81,99.78 136.9,120.39 120.05,136.72 100.05,136.74 79.76,136.75 63.24,120.35 63.17,99.96 63.12,79.96 79.26,63.16 99.91,63.09z M126.27,99.95C126.29,85.41 114.55,73.65 100,73.63 85.53,73.61 73.78,85.34 73.73,99.85 73.68,114.38 85.46,126.21 100.05,126.17 114.9,126.12 126.25,114.1 126.27,99.95z" />
                                            </DrawingGroup>
                                        </DrawingImage.Drawing>
                                    </DrawingImage>
                                </Image.Source>
                            </Image>
                        </Button>
                        <!-- Import Button -->
                        <Button x:Name="ButtonChargerProject"
                                Style="{StaticResource ChargerButton}"
                                Margin="0,0,10,0" Click="ImportProjectButtonClick"/>
                        <!-- Export Button -->
                        <Button x:Name="ButtonExportProject"
                                Style="{StaticResource ExportButton}"
                                IsEnabled="{Binding IsProjectImported}"
                                Margin="0,0,-10,0"
                                Click="ExportModifiedProjectButtonClick"/>
                    </StackPanel>
                </Grid>
            
                <!-- Arbres -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <!-- Panneau de gauche -->
                        <ColumnDefinition Width="*"/>
                        <!-- Barre centrale -->
                        <ColumnDefinition Width="Auto"/>
                        <!-- Panneau de droite -->
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Adresses de Groupes Originales -->
                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <!-- Barre avec le titre -->
                            <RowDefinition Height="Auto"/>
                            <!-- Affichage en dessous -->
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Border x:Name="BorderTitrePanneauGauche" Grid.Row="0" BorderBrush="#D7D7D7" BorderThickness="0,0,0,1" />

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- Titre et Icon -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left"  VerticalAlignment="Top"  >
                                <Image x:Name="ImageAdressesGauche" Height="15" Margin="10">
                                    <Image.Source>
                                        <DrawingImage >
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V365.2 H352 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FF9199A3">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="19,39.2,302,302" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,101.2,261,222" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FF3C4B5E">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,79.2,261,22" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <DrawingGroup Opacity="1">
                                                            <GeometryDrawing Brush="#FF334A9A">
                                                                <GeometryDrawing.Geometry>
                                                                    <RectangleGeometry RadiusX="0" RadiusY="0" Rect="99.25,141.2,59.5,59.5" />
                                                                </GeometryDrawing.Geometry>
                                                            </GeometryDrawing>
                                                            <GeometryDrawing Brush="#FF334A9A">
                                                                <GeometryDrawing.Geometry>
                                                                    <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,141.2,59.5,59.5" />
                                                                </GeometryDrawing.Geometry>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                        <GeometryDrawing Brush="#FF334A9A">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="99.25,222.2,59.5,59.5" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FF334A9A">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,222.2,59.5,59.5" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,59.2,82,20" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,59.2,18.75,19" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="222,59.2,19,19" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFB82318">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="264,59.2,20,20" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                                <TextBlock x:Name="TextBlockAdressesGauche" FontSize="12" FontWeight="Bold" Margin="0,10" />

                                <!-- Buttons de la console -->
                                <Button Name="OpenConsoleButton" Click="OpenConsoleButtonClick" Width="50"  Margin="10,0" Style="{StaticResource ToggleButtonStyle}" Height="25"/>

                            </StackPanel>


                            <!-- Bouton déploiement -->
                            <Button Grid.Column="1" x:Name="BtnToggleArrowGauche" Click="btnCollapseAndToggle_Click" Width="25" Height="25" HorizontalAlignment="Right" Margin="0,5,5,5" Style="{StaticResource ToggleButtonStyle}" >
                                <Image x:Name="ChevronImage" Width="10" Height="10"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                    Stretch="Fill">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                                                    <DrawingGroup.Transform>
                                                        <RotateTransform Angle="-90" x:Name="RotateTransform"/>
                                                    </DrawingGroup.Transform>
                                                    <DrawingGroup Opacity="1" Transform="0.1,0,0,-0.1,0,512">
                                                        <GeometryDrawing x:Name="ChevronPanGauche" Brush="#FF000000" Geometry="F1 M512,512z M0,0z M131,3836L-1,3704 1274,2432C1974,1732 2553,1160 2560,1160 2567,1160 3146,1732 3846,2432L5121,3704 4989,3836 4857,3969 3713,2832C3084,2207 2565,1695 2560,1695 2555,1695 2036,2207 1407,2832L263,3969 131,3836z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Button>

                        </Grid>

                        <!-- Arbre Gauche -->
                        <ScrollViewer Grid.Row="1" Name="ScrollViewerGauche" BorderBrush="Transparent" BorderThickness="0" ScrollChanged="ScrollViewer_ScrollChanged" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Hidden" Padding="10" Background="White">
                            <TreeView x:Name="TreeViewGauche" Foreground="Black" ItemContainerStyle="{StaticResource TreeViewItemStyle2}" BorderThickness="0" Background="Transparent" />
                        </ScrollViewer>
                    </Grid>

                    <!-- Bordure de contour Gauche/-->
                    <Border Grid.Column="0" x:Name="BorderPanGauche" BorderBrush="#D7D7D7 " BorderThickness="1,1,0,1" Padding="10" CornerRadius="0"/>

                    <!-- Ajuster les largeurs de fenêtres -->
                    <GridSplitter Grid.Column="1" x:Name="AjusteurPan" Width="2.5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="#D7D7D7"/>

                    <!-- Adresses de Groupes Originales/-->
                    <Grid Grid.Column="2" >
                        <Grid.RowDefinitions>
                            <!-- Barre avec le titre -->
                            <RowDefinition Height="Auto"/>
                            <!-- Affichage en dessous -->
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Border x:Name="BorderTitrePanneauDroite" Grid.Row="0" BorderBrush="#D7D7D7" BorderThickness="0,0,0,1"/>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- Titre et Icon droit/-->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left"  VerticalAlignment="Center" >
                                <Image x:Name="ImageAdressesDroite" Height="15" Margin="10">
                                    <Image.Source>
                                        <DrawingImage >
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V365.2 H352 V0 H0 Z">
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FF9199A3">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="19,39.2,302,302" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>
                                                    <DrawingGroup Opacity="1">
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,101.2,261,222" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FF3C4B5E">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,79.2,261,22" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <DrawingGroup Opacity="1">
                                                            <GeometryDrawing Brush="#FF334A9A">
                                                                <GeometryDrawing.Geometry>
                                                                    <RectangleGeometry RadiusX="0" RadiusY="0" Rect="99.25,141.2,59.5,59.5" />
                                                                </GeometryDrawing.Geometry>
                                                            </GeometryDrawing>
                                                            <GeometryDrawing Brush="#FF334A9A">
                                                                <GeometryDrawing.Geometry>
                                                                    <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,141.2,59.5,59.5" />
                                                                </GeometryDrawing.Geometry>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                        <GeometryDrawing Brush="#FF334A9A">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="99.25,222.2,59.5,59.5" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FF334A9A">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,222.2,59.5,59.5" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="39,59.2,82,20" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="180.25,59.2,18.75,19" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFE4E5E4">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="222,59.2,19,19" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                        <GeometryDrawing Brush="#FFB82318">
                                                            <GeometryDrawing.Geometry>
                                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="264,59.2,20,20" />
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                                <TextBlock x:Name="TextBlockAdressesDroite" FontSize="12" FontWeight="Bold" Margin="0,10" TextTrimming="CharacterEllipsis" />
                            </StackPanel>

                            <!-- Bouton déploiement droit/-->

                            <Button Grid.Column="1" x:Name="BtnToggleArrowDroite" Click="btnCollapseAndToggle_Click" Width="25" Height="25" HorizontalAlignment="Right" Margin="0,5,5,5"  Style="{StaticResource ToggleButtonStyle}" >
                                <Image x:Name="ChevronImage2" Width="10" Height="10"
                                   VerticalAlignment="Center" HorizontalAlignment="Center"
                                   Stretch="Fill">
                                    <Image.Source>
                                        <DrawingImage>
                                            <DrawingImage.Drawing>
                                                <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                                                    <DrawingGroup.Transform>
                                                        <RotateTransform Angle="-90"  x:Name="RotateTransform2"/>
                                                    </DrawingGroup.Transform>
                                                    <DrawingGroup Opacity="1" Transform="0.1,0,0,-0.1,0,512">
                                                        <GeometryDrawing x:Name="ChevronPanDroite" Brush="#FF000000" Geometry="F1 M512,512z M0,0z M131,3836L-1,3704 1274,2432C1974,1732 2553,1160 2560,1160 2567,1160 3146,1732 3846,2432L5121,3704 4989,3836 4857,3969 3713,2832C3084,2207 2565,1695 2560,1695 2555,1695 2036,2207 1407,2832L263,3969 131,3836z" />
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingImage.Drawing>
                                        </DrawingImage>
                                    </Image.Source>
                                </Image>
                            </Button>

                        </Grid>
                        <!-- Arbre Droite -->
                        <ScrollViewer Grid.Row="1" Name="ScrollViewerDroite" ScrollChanged="ScrollViewer_ScrollChanged" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Padding="10" Background="White">
                            <TreeView x:Name="TreeViewDroite" Foreground="Black" ItemContainerStyle="{StaticResource TreeViewItemStyle2}" BorderThickness="0"  Background="Transparent" MouseDoubleClick="RenameWindow"/>
                        </ScrollViewer>

                    </Grid>

                    <!-- Bordure de contour Droit/-->
                    <Border Grid.Column="2" x:Name="BorderPanDroit" BorderBrush="#D7D7D7 " BorderThickness="0,1,1,1" CornerRadius="0"/>
                </Grid>
            </Grid>
        

            <!-- Couche de désactivation -->
            <Grid x:Name="OverlayLight" Background="White" Opacity="0.5" Visibility="Collapsed">
                <TextBlock Text="Veuillez patienter..." HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="24" Foreground="Black"/>
            </Grid>
            <Grid x:Name="OverlayDark" Background="#313131" Opacity="0.5" Visibility="Collapsed">
                <TextBlock Text="Veuillez patienter..." HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="24" Foreground="White"/>
            </Grid>
        </Grid>

    </Border>
</mah:MetroWindow>
